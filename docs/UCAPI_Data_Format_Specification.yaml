# UCAPI Data Format Specification
# This YAML defines the file specification for UniversalCameraworkAPI.
# All multi-byte values are encoded in little-endian.

Header:
  magic: uint16_t            # Magic number (e.g. 0x55AA)
  version: uint16_t          # Packet format version (e.g. 0x0002)
  numPayload: uint16_t       # Number of records in this packet
  payloadLength: uint16_t    # Total length of payload in bytes (e.g. 128)
  crc16: uint16_t            # CRC-16 checksum of payload[]

Payload:
  type: Record               # UCAPI record
  repeat: numPayload         # Number of records = numPayload

Timecode:
  format: SMPTE_80_bit       # SMPTE Linear Timecode 80-bit format
  structure:
    time_address: bits[26]   # BCD encoded time (hours, minutes, seconds, frames)
    user_bits: bits[32]      # 8 groups of 4-bit user data
    sync_word: bits[16]      # SMPTE sync word (0x3FFD)
    control_bits: bits[6]    # Drop frame, color frame, phase correction flags
  encoding: BCD              # Binary Coded Decimal for time components
  subframe: float            # Separate subframe concept (game engine specific)

Record:
  # Structure of each fixed-length data record
  cameraNo: uint32_t         # Camera number
  commands: uint16_t         # Command bit field (e.g., DOF_ENABLE = 0x04, LENS_DISTORTION_ENABLE = 0x08)
  timecode: SMPTE_80_bit     # SMPTE Linear Timecode 80-bit format (10 bytes)
  subframe: float            # Precise timing that cannot be expressed by timecode (game engine specific)
  packetNo: uint8_t          # Packet number

  # Camera position and orientation (units: meters or as appropriate)
  eyePosition_right_m: float
  eyePosition_up_m: float
  eyePosition_forward_m: float
  lookVector_right_m: float
  lookVector_up_m: float
  lookVector_forward_m: float
  upVector_right_m: float
  upVector_up_m: float
  upVector_forward_m: float

  # Camera parameters
  focalLength_mm: float
  aspectRatio: float
  focusDistance_m: float
  aperture: float
  sensorSize_width_mm: float
  sensorSize_height_mm: float
  nearClip_m: float
  farClip_m: float
  lensShift_horizontal_ratio: float
  lensShift_vertical_ratio: float
  lensDistortion_RadialCoefficients_k1: float
  lensDistortion_RadialCoefficients_k2: float
  lensDistortion_CenterPoint_right_mm: float
  lensDistortion_CenterPoint_up_mm: float

  # Reserved area: 25 bytes reserved to make the entire header 128 bytes
  reserved: uint8_t[25]
  