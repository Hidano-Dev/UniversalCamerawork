# UCAPI Data Format Specification
# This YAML defines the file specification for UniversalCameraworkAPI.
# All multi-byte values are encoded in little-endian.

Header:
  magic: uint16_t            # Magic number (e.g. 0x55AA)
  version: uint16_t          # Packet format version (e.g. 0x0002)
  numPayload: uint16_t       # Number of records in this packet
  payloadLength: uint16_t    # Total length of payload in bytes (e.g. 128)
  crc16: uint16_t            # CRC-16 checksum of payload[]

Payload:
  type: Record               # UCAPI record
  repeat: numPayload         # Number of records = numPayload

Timecode:
  frameNumber: bits[8]       # 8-bit frame number
  secondNumber: bits[6]      # 6-bit second number
  minuteNumber: bits[6]      # 6-bit minute number
  hourNumber: bits[5]        # 5-bit hour number
  frameRate: bits[4]         # 4-bit frame rate (23.976, 24, 25, 29.97, 30, 48, 50, 59.94, 60, 119.88, 120, 144, 239.76, 240)
  dropFrame: bits[1]         # 1-bit drop frame (0=NonDrop, 1=Drop)
  reserved: bits[2]          # 3-bit reserved

Record:
  # Structure of each fixed-length data record
  cameraNo: uint32_t         # Camera number
  commands: uint16_t         # Command bit field (e.g., DOF_ENABLE = 0x04, LENS_DISTORTION_ENABLE = 0x08)
  timecode: Timecode         # Timecode information (bit allocations defined elsewhere)
  packetNo: uint8_t          # Packet number

  # Camera position and orientation (units: meters or as appropriate)
  eyePosition_right_m: float
  eyePosition_up_m: float
  eyePosition_forward_m: float
  lookVector_right_m: float
  lookVector_up_m: float
  lookVector_forward_m: float
  upVector_right_m: float
  upVector_up_m: float
  upVector_forward_m: float

  # Camera parameters
  focalLength_mm: float
  aspectRatio: float
  focusDistance_m: float
  aperture: float
  sensorSize_width_mm: float
  sensorSize_height_mm: float
  nearClip_m: float
  farClip_m: float
  lensShift_horizontal_ratio: float
  lensShift_vertical_ratio: float
  lensDistortion_RadialCoefficients_k1: float
  lensDistortion_RadialCoefficients_k2: float
  lensDistortion_CenterPoint_right_mm: float
  lensDistortion_CenterPoint_up_mm: float

  # Reserved area: 25 bytes reserved to make the entire header 128 bytes
  reserved: uint8_t[25]
  